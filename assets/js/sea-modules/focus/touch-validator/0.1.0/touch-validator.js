define("focus/touch-validator/0.1.0/touch-validator-util",["$"],function(a){var d=a("$"),e={normalizeRule:function(a){if("string"==typeof a){var b={};d.each(a.split(/\s/),function(){b[this]=!0}),a=b}return a},checkable:function(a){return/radio|checkbox/i.test(a.type)},depend:function(a,b){switch(typeof a){case"boolean":return a;case"string":return d(a,b.form).length>0;case"function":return a(b);default:return!0}},elementValue:function(a){var b=d(a).attr("type"),c=d(a).val();return"radio"===b||"checkbox"===b?c=d('input[name="'+d(a).attr("name")+'"]:checked').val():"string"==typeof c&&(c=c.replace(/\r/g,"")),c},findByName:function(a){return d('[name="'+a.name+'"]',a.form)},getLength:function(a,b){switch(b.nodeName.toLowerCase()){case"select":return d("option:selected",b).length;case"input":return this.checkable(b)?this.findByName(b).filter(":checked").length:a.length}},formatMessage:function(a,b){return b.constructor!==Array&&(b=[b]),d.each(b,function(b,c){a=a.replace(new RegExp("\\{"+b+"\\}","g"),c)}),a}};return e}),define("focus/touch-validator/0.1.0/touch-validator-methods",["./touch-validator-util","$","underscore"],function(a){var d=a("$"),e=a("underscore"),f=a("./touch-validator-util"),g={methods:{required:function(a,b,c){if(!f.depend(c,b))return!0;if("select"===b.nodeName.toLowerCase()){var e=d(b).val();return e&&e.length>0}return f.checkable(b)?f.getLength(a,b)>0:d.trim(a).length>0},remote:function(a,b,c){if(g.optional(b))return!0;if(this.pending[b.name])return"pending";var e=this.previousValue(b);if(e.old===a)return e.valid;e.old=a;var f=this;this.startRequest(b),c="string"==typeof c?{url:c}:c;var h={};return h[b.name]=a,d.ajax(d.extend({uid:"validate"+b.name,dataType:"json",data:h,beforeSend:function(a,b){f.ajaxRequests[b.uid]&&f.ajaxRequests[b.uid].abort(),f.ajaxRequests[b.uid]=a},success:function(a){var c=a===!0||"true"===a;c?f.errorsFor(b).hide():(f.settings.messages[b.name]||(f.settings.messages[b.name]={}),e.message=f.settings.messages[b.name].remote=a,f.addError(b,{method:"remote"}),f.showErrors()),e.valid=c,d(b).data("previousValue",JSON.stringify(e)),f.stopRequest(b,c)}},c)),"pending"},minlength:function(a,b,c){var h=e.isArray(a)?a.length:f.getLength(d.trim(a),b);return g.optional(b)||h>=c},maxlength:function(a,b,c){var h=e.isArray(a)?a.length:f.getLength(d.trim(a),b);return g.optional(b)||c>=h},rangelength:function(a,b,c){var h=e.isArray(a)?a.length:f.getLength(d.trim(a),b);return g.optional(b)||h>=c[0]&&c[1]>=h},min:function(a,b,c){return g.optional(b)||parseInt(a)>=f.depend(c,b)},max:function(a,b,c){return g.optional(b)||parseInt(a)<=f.depend(c,b)},range:function(a,b,c){return g.optional(b)||a>=c[0]&&c[1]>=a},email:function(a,b){return g.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},equalTo:function(a,b,c){var e=d(c);return a===e.val()}},methodMessages:{required:"请填写该字段",remote:"请修正该字段",email:"请输入正确的Email",url:"请输入正确的URL",number:"请输入合法的数字",digits:"请输入数字",equalTo:"请再次输入相同的值",maxlength:"请输入长度最大为{0}的字符串",minlength:"请输入长度至少为{0}的字符串",rangelength:"请输入长度在{0}到{1}之间的字符串",range:"请输入介于{0}和{1}之间的数字",max:"请输入最大为{0}的数字",min:"请输入最小为{0}的数字"},optional:function(a){var b=f.elementValue(a);return!g.methods.required.call(this,b,a)}};return g}),define("focus/touch-validator/0.1.0/touch-validator",["./touch-validator-util","./touch-validator-methods","underscore","$"],function(a){var d=a("underscore"),e=a("$"),f=a("./touch-validator-util"),g=a("./touch-validator-methods"),h=function(a,b){d.bindAll(this),this.$form=e(a),this.settings=d.extend({},h.defaults,b),this.storeRules(),this.init()};return d.extend(h.prototype,{storeRules:function(){this.rules=this.settings.rules||{},d.each(this.rules,function(a,b){this.rules[b]=f.normalizeRule(a)},this)},init:function(){this.valueCache={},this.pendingRequest=0,this.ajaxRequests={},this.pending={},this.reset(),this.$form.on("focusin focusout",'[type="text"], [type="password"], [type="file"], select, textarea, [type="number"], [type="search"] ,[type="tel"], [type="url"], [type="email"], [type="datetime"], [type="date"], [type="month"], [type="week"], [type="time"], [type="datetime-local"], [type="range"], [type="color"] ',this.hanldeFieldEvent),this.$form.on("click",'[type="radio"], [type="checkbox"], select, option',this.hanldeFieldEvent),this.$form.prop("noValidate",!0).on("submit",this.handleSubmit)},hanldeFieldEvent:function(a){var b="on"+a.type;this.settings[b]&&this.settings[b].call(this,a.target,a)},handleSubmit:function(a){return this.validateForm()?this.pendingRequest>0?(this.formNeedSubmit=!0,!1):this.settings.submitHandler?(this.settings.submitHandler.call(this,this.$form[0],a),!1):void 0:!1},validateForm:function(){var a=this.checkForm();return this.errors().hide(),a||this.showErrors(),a},validateElement:function(a){if(e(a).is(this.settings.ignore))return!0;a=this.validationTargetFor(a),this.reset();var b=this.check(a);return b?this.errorsFor(a).hide():this.showErrors(),b},check:function(a){a=this.validationTargetFor(a);var b=this.rulesFor(a),c=e(a).val();for(var d in b){var f={method:d,parameters:b[d]};try{var g=h.methods[d].call(this,c,a,f.parameters);if("pending"===g)return!0;if(!g)return this.addError(a,f),!1}catch(i){throw this.settings.debug&&window.console&&console.log("exception occured when checking element "+a.id+", check the '"+f.method+"' method",i),i}}return!0},checkForm:function(){return this.reset(),d.each(this.allElements(),function(a){this.check(a)},this),0===this.errorList.length},showErrors:function(){if(this.settings.highlight&&d.each(this.errorList[i],function(a){this.settings.highlight.call(this,a.element)},this),this.settings.unhighlight){var b=d(this.errorList).map(function(){return this.element});d(this.allElements().not(b)).each(function(a){this.settings.unhighlight.call(this,a)},this)}this.settings.showErrors.call(this)},addError:function(a,b){var c=this.messageFor(a,b);this.errorList.push({message:c,element:a}),this.errorMap[a.name]=c},messageFor:function(a,b){var c=this.settings.messages[a.name];"object"==typeof c&&(c=c[b.method]),c||(c=h.methodMessages[b.method]||"缺少错误提示");var d=/\$?\{(\d+)\}/g;return"function"==typeof c?c=c.call(this,b.parameters,a):d.test(c)&&(c=h.formatMessage(c.replace(d,"{$1}"),b.parameters)),c},allElements:function(){var a={},b=this,c=this.$form.find("input, select, textarea").not('[type="submit"], [type="reset"], [type="image"], [disabled]').not(this.settings.ignore).filter(function(){return this.name in a||d.isEmpty(b.rulesFor(this))?!1:(a[this.name]=!0,!0)});return c},rulesFor:function(a){var b=d.extend({},this.rules[a.name]);if(b.required){var c=b.required;delete b.required,b=e.extend({required:c},b)}return b},validationTargetFor:function(a){return f.checkable(a)&&(a=f.findByName(a).not(this.settings.ignore)[0]),a},reset:function(){this.errorList=[],this.errorMap={},this.currentElements=e([])},errorsFor:function(a){var b=this.idOrName(a);return this.errors().filter('[for="'+b+'"]')},idOrName:function(a){return f.checkable(a)?a.name:a.id||a.name},errors:function(){var a=this.settings.errorClass.replace(" ",".");return e(this.settings.errorElement+"."+a,this.$form)},showErrorLabel:function(a,b){var c=this.errorsFor(a);c.length>0?c.html(b||"").show():(c=e("<"+this.settings.errorElement+"/>").attr("for",this.idOrName(a)).addClass(this.settings.errorClass).html(b||""),this.settings.errorPlacement?this.settings.errorPlacement.call(this,c,e(a)):c.insertAfter(a))},startRequest:function(a){this.pending[a.name]||(this.pendingRequest++,this.pending[a.name]=!0)},stopRequest:function(a,b){this.pendingRequest--,0>this.pendingRequest&&(this.pendingRequest=0),delete this.pending[a.name],b&&0===this.pendingRequest&&this.formNeedSubmit&&this.checkForm()?(this.$form.submit(),this.formNeedSubmit=!1):!b&&0===this.pendingRequest&&this.formNeedSubmit&&(this.formNeedSubmit=!1)},previousValue:function(a){var b=e(a).data("previousValue");if(!b){var c={old:null,valid:!0};e(a).data("previousValue",JSON.stringify(c))}return b?JSON.parse(b):c}}),d.extend(h,{defaults:{errorClass:"error",errorElement:"label",ignore:"null",messages:{},onfocusout:function(a){f.checkable(a)||this.validateElement(a)},showErrors:function(){d.each(this.errorList,function(a){this.showErrorLabel(a.element,a.message)},this)}},addMethod:function(a,b,c){h.methods[a]=b,h.methodMessages[a]=c},setDefaults:function(a){d.extend(this.defaults,a)}},g,f),h});