define("focus/touch-validator/0.1.0/touch-validator-util",["$"],function(e){var t=e("$"),r={normalizeRule:function(e){if("string"==typeof e){var r={};t.each(e.split(/\s/),function(){r[this]=!0}),e=r}return e},checkable:function(e){return/radio|checkbox/i.test(e.type)},depend:function(e,r){switch(typeof e){case"boolean":return e;case"string":return t(e,r.form).length>0;case"function":return e(r);default:return!0}},elementValue:function(e){var r=t(e).attr("type"),i=t(e).val();return"radio"===r||"checkbox"===r?i=t('input[name="'+t(e).attr("name")+'"]:checked').val():"string"==typeof i&&(i=i.replace(/\r/g,"")),i},findByName:function(e){return t('[name="'+e.name+'"]',e.form)},getLength:function(e,r){switch(r.nodeName.toLowerCase()){case"select":return t("option:selected",r).length;case"input":return this.checkable(r)?this.findByName(r).filter(":checked").length:e.length}},formatMessage:function(e,r){return r.constructor!==Array&&(r=[r]),t.each(r,function(t,r){e=e.replace(new RegExp("\\{"+t+"\\}","g"),r)}),e}};return r}),define("focus/touch-validator/0.1.0/touch-validator-methods",["./touch-validator-util","$","underscore"],function(e){var t=e("$"),r=e("underscore"),i=e("./touch-validator-util"),n={methods:{required:function(e,r,n){if(!i.depend(n,r))return!0;if("select"===r.nodeName.toLowerCase()){var s=t(r).val();return s&&s.length>0}return i.checkable(r)?i.getLength(e,r)>0:t.trim(e).length>0},remote:function(e,r,i){if(n.optional(r))return!0;if(this.pending[r.name])return"pending";var s=this.previousValue(r);if(s.old===e)return s.valid;s.old=e;var a=this;this.startRequest(r),i="string"==typeof i?{url:i}:i;var u={};return u[r.name]=e,t.ajax(t.extend({uid:"validate"+r.name,dataType:"json",data:u,beforeSend:function(e,t){a.ajaxRequests[t.uid]&&a.ajaxRequests[t.uid].abort(),a.ajaxRequests[t.uid]=e},success:function(e){var i=e===!0||"true"===e;i?a.errorsFor(r).hide():(a.settings.messages[r.name]||(a.settings.messages[r.name]={}),s.message=a.settings.messages[r.name].remote=e,a.addError(r,{method:"remote"}),a.showErrors()),s.valid=i,t(r).data("previousValue",JSON.stringify(s)),a.stopRequest(r,i)}},i)),"pending"},minlength:function(e,s,a){var u=r.isArray(e)?e.length:i.getLength(t.trim(e),s);return n.optional(s)||u>=a},maxlength:function(e,s,a){var u=r.isArray(e)?e.length:i.getLength(t.trim(e),s);return n.optional(s)||a>=u},rangelength:function(e,s,a){var u=r.isArray(e)?e.length:i.getLength(t.trim(e),s);return n.optional(s)||u>=a[0]&&a[1]>=u},min:function(e,t,r){return n.optional(t)||parseInt(e)>=i.depend(r,t)},max:function(e,t,r){return n.optional(t)||parseInt(e)<=i.depend(r,t)},range:function(e,t,r){return n.optional(t)||e>=r[0]&&r[1]>=e},email:function(e,t){return n.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},equalTo:function(e,r,i){var n=t(i);return e===n.val()}},methodMessages:{required:"请填写该字段",remote:"请修正该字段",email:"请输入正确的Email",url:"请输入正确的URL",number:"请输入合法的数字",digits:"请输入数字",equalTo:"请再次输入相同的值",maxlength:"请输入长度最大为{0}的字符串",minlength:"请输入长度至少为{0}的字符串",rangelength:"请输入长度在{0}到{1}之间的字符串",range:"请输入介于{0}和{1}之间的数字",max:"请输入最大为{0}的数字",min:"请输入最小为{0}的数字"},optional:function(e){var t=i.elementValue(e);return!n.methods.required.call(this,t,e)}};return n}),define("focus/touch-validator/0.1.0/touch-validator",["./touch-validator-util","./touch-validator-methods","underscore","$"],function(e){var t=e("underscore"),r=e("$"),n=e("./touch-validator-util"),s=e("./touch-validator-methods"),a=function(e,i){t.bindAll(this),this.$form=r(e),this.settings=t.extend({},a.defaults,i),this.storeRules(),this.init()};return t.extend(a.prototype,{storeRules:function(){this.rules=this.settings.rules||{},t.each(this.rules,function(e,t){this.rules[t]=n.normalizeRule(e)},this)},init:function(){this.valueCache={},this.pendingRequest=0,this.ajaxRequests={},this.pending={},this.reset(),this.$form.on("focusin focusout",'[type="text"], [type="password"], [type="file"], select, textarea, [type="number"], [type="search"] ,[type="tel"], [type="url"], [type="email"], [type="datetime"], [type="date"], [type="month"], [type="week"], [type="time"], [type="datetime-local"], [type="range"], [type="color"] ',this.hanldeFieldEvent),this.$form.on("click",'[type="radio"], [type="checkbox"], select, option',this.hanldeFieldEvent),this.$form.prop("noValidate",!0).on("submit",this.handleSubmit)},hanldeFieldEvent:function(e){var t="on"+e.type;this.settings[t]&&this.settings[t].call(this,e.target,e)},handleSubmit:function(e){return this.validateForm()?this.pendingRequest>0?(this.formNeedSubmit=!0,!1):this.settings.submitHandler?(this.settings.submitHandler.call(this,this.$form[0],e),!1):void 0:!1},validateForm:function(){var e=this.checkForm();return this.errors().hide(),e||this.showErrors(),e},validateElement:function(e){if(r(e).is(this.settings.ignore))return!0;e=this.validationTargetFor(e),this.reset();var t=this.check(e);return t?this.errorsFor(e).hide():this.showErrors(),t},check:function(e){e=this.validationTargetFor(e);var t=this.rulesFor(e),i=r(e).val();for(var n in t){var s={method:n,parameters:t[n]};try{var u=a.methods[n].call(this,i,e,s.parameters);if("pending"===u)return!0;if(!u)return this.addError(e,s),!1}catch(o){throw this.settings.debug&&window.console&&console.log("exception occured when checking element "+e.id+", check the '"+s.method+"' method",o),o}}return!0},checkForm:function(){return this.reset(),t.each(this.allElements(),function(e){this.check(e)},this),0===this.errorList.length},showErrors:function(){if(this.settings.highlight&&t.each(this.errorList[i],function(e){this.settings.highlight.call(this,e.element)},this),this.settings.unhighlight){var e=t(this.errorList).map(function(){return this.element});t(this.allElements().not(e)).each(function(e){this.settings.unhighlight.call(this,e)},this)}this.settings.showErrors.call(this)},addError:function(e,t){var r=this.messageFor(e,t);this.errorList.push({message:r,element:e}),this.errorMap[e.name]=r},messageFor:function(e,t){var r=this.settings.messages[e.name];"object"==typeof r&&(r=r[t.method]),r||(r=a.methodMessages[t.method]||"缺少错误提示");var i=/\$?\{(\d+)\}/g;return"function"==typeof r?r=r.call(this,t.parameters,e):i.test(r)&&(r=a.formatMessage(r.replace(i,"{$1}"),t.parameters)),r},allElements:function(){var e={},r=this,i=this.$form.find("input, select, textarea").not('[type="submit"], [type="reset"], [type="image"], [disabled]').not(this.settings.ignore).filter(function(){return this.name in e||t.isEmpty(r.rulesFor(this))?!1:(e[this.name]=!0,!0)});return i},rulesFor:function(e){var i=t.extend({},this.rules[e.name]);if(i.required){var n=i.required;delete i.required,i=r.extend({required:n},i)}return i},validationTargetFor:function(e){return n.checkable(e)&&(e=n.findByName(e).not(this.settings.ignore)[0]),e},reset:function(){this.errorList=[],this.errorMap={},this.currentElements=r([])},errorsFor:function(e){var t=this.idOrName(e);return this.errors().filter('[for="'+t+'"]')},idOrName:function(e){return n.checkable(e)?e.name:e.id||e.name},errors:function(){var e=this.settings.errorClass.replace(" ",".");return r(this.settings.errorElement+"."+e,this.$form)},showErrorLabel:function(e,t){var i=this.errorsFor(e);i.length>0?i.html(t||"").show():(i=r("<"+this.settings.errorElement+"/>").attr("for",this.idOrName(e)).addClass(this.settings.errorClass).html(t||""),this.settings.errorPlacement?this.settings.errorPlacement.call(this,i,r(e)):i.insertAfter(e))},startRequest:function(e){this.pending[e.name]||(this.pendingRequest++,this.pending[e.name]=!0)},stopRequest:function(e,t){this.pendingRequest--,0>this.pendingRequest&&(this.pendingRequest=0),delete this.pending[e.name],t&&0===this.pendingRequest&&this.formNeedSubmit&&this.checkForm()?(this.$form.submit(),this.formNeedSubmit=!1):!t&&0===this.pendingRequest&&this.formNeedSubmit&&(this.formNeedSubmit=!1)},previousValue:function(e){var t=r(e).data("previousValue");if(!t){var i={old:null,valid:!0};r(e).data("previousValue",JSON.stringify(i))}return t?JSON.parse(t):i}}),t.extend(a,{defaults:{errorClass:"error",errorElement:"label",ignore:"null",messages:{},onfocusout:function(e){n.checkable(e)||this.validateElement(e)},showErrors:function(){t.each(this.errorList,function(e){this.showErrorLabel(e.element,e.message)},this)}},addMethod:function(e,t,r){a.methods[e]=t,a.methodMessages[e]=r},setDefaults:function(e){t.extend(this.defaults,e)}},s,n),a});