define("focus/touch-validator/0.1.0/touch-validator-util-debug",["$-debug"],function(require,e,t){var $=require("$-debug"),r={normalizeRule:function(e){if("string"==typeof e){var t={};$.each(e.split(/\s/),function(){t[this]=!0}),e=t}return e},checkable:function(e){return/radio|checkbox/i.test(e.type)},depend:function(e,t){switch(typeof e){case"boolean":return e;case"string":return $(e,t.form).length>0;case"function":return e(t);default:return!0}},elementValue:function(e){var t=$(e).attr("type"),r=$(e).val();return"radio"===t||"checkbox"===t?r=$('input[name="'+$(e).attr("name")+'"]:checked').val():"string"==typeof r&&(r=r.replace(/\r/g,"")),r},findByName:function(e){return $('[name="'+e.name+'"]',e.form)},getLength:function(e,t){switch(t.nodeName.toLowerCase()){case"select":return $("option:selected",t).length;case"input":return this.checkable(t)?this.findByName(t).filter(":checked").length:e.length}},formatMessage:function(e,t){return t.constructor!==Array&&(t=[t]),$.each(t,function(t,r){e=e.replace(new RegExp("\\{"+t+"\\}","g"),r)}),e}};return r}),define("focus/touch-validator/0.1.0/touch-validator-methods-debug",["./touch-validator-util-debug","$-debug","underscore-debug"],function(require,e,t){var $=require("$-debug"),r=require("underscore-debug"),i=require("./touch-validator-util-debug"),n={methods:{required:function(e,t,r){if(!i.depend(r,t))return!0;if("select"===t.nodeName.toLowerCase()){var n=$(t).val();return n&&n.length>0}return i.checkable(t)?i.getLength(e,t)>0:$.trim(e).length>0},remote:function(e,t,r){if(n.optional(t))return!0;if(this.pending[t.name])return"pending";var i=this.previousValue(t);if(i.old===e)return i.valid;i.old=e;var s=this;this.startRequest(t),r="string"==typeof r?{url:r}:r;var u={};return u[t.name]=e,$.ajax($.extend({uid:"validate"+t.name,dataType:"json",data:u,beforeSend:function(e,t){s.ajaxRequests[t.uid]&&s.ajaxRequests[t.uid].abort(),s.ajaxRequests[t.uid]=e},success:function(e){var r=e===!0||"true"===e;r?s.errorsFor(t).hide():(s.settings.messages[t.name]||(s.settings.messages[t.name]={}),i.message=s.settings.messages[t.name].remote=e,s.addError(t,{method:"remote"}),s.showErrors()),i.valid=r,$(t).data("previousValue",JSON.stringify(i)),s.stopRequest(t,r)}},r)),"pending"},minlength:function(e,t,s){var u=r.isArray(e)?e.length:i.getLength($.trim(e),t);return n.optional(t)||u>=s},maxlength:function(e,t,s){var u=r.isArray(e)?e.length:i.getLength($.trim(e),t);return n.optional(t)||s>=u},rangelength:function(e,t,s){var u=r.isArray(e)?e.length:i.getLength($.trim(e),t);return n.optional(t)||u>=s[0]&&u<=s[1]},min:function(e,t,r){return n.optional(t)||parseInt(e)>=i.depend(r,t)},max:function(e,t,r){return n.optional(t)||parseInt(e)<=i.depend(r,t)},range:function(e,t,r){return n.optional(t)||e>=r[0]&&e<=r[1]},email:function(e,t){return n.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},equalTo:function(e,t,r){var i=$(r);return e===i.val()}},methodMessages:{required:"请填写该字段",remote:"请修正该字段",email:"请输入正确的Email",url:"请输入正确的URL",number:"请输入合法的数字",digits:"请输入数字",equalTo:"请再次输入相同的值",maxlength:"请输入长度最大为{0}的字符串",minlength:"请输入长度至少为{0}的字符串",rangelength:"请输入长度在{0}到{1}之间的字符串",range:"请输入介于{0}和{1}之间的数字",max:"请输入最大为{0}的数字",min:"请输入最小为{0}的数字"},optional:function(e){var t=i.elementValue(e);return!n.methods.required.call(this,t,e)}};return n}),define("focus/touch-validator/0.1.0/touch-validator-debug",["./touch-validator-util-debug","./touch-validator-methods-debug","underscore-debug","$-debug"],function(require,e,t){var r=require("underscore-debug"),$=require("$-debug"),n=require("./touch-validator-util-debug"),s=require("./touch-validator-methods-debug"),u=function(e,t){r.bindAll(this),this.$form=$(e),this.settings=r.extend({},u.defaults,t),this.storeRules(),this.init()};return r.extend(u.prototype,{storeRules:function(){this.rules=this.settings.rules||{},r.each(this.rules,function(e,t){this.rules[t]=n.normalizeRule(e)},this)},init:function(){this.valueCache={},this.pendingRequest=0,this.ajaxRequests={},this.pending={},this.reset(),this.$form.on("focusin focusout",'[type="text"], [type="password"], [type="file"], select, textarea, [type="number"], [type="search"] ,[type="tel"], [type="url"], [type="email"], [type="datetime"], [type="date"], [type="month"], [type="week"], [type="time"], [type="datetime-local"], [type="range"], [type="color"] ',this.hanldeFieldEvent),this.$form.on("click",'[type="radio"], [type="checkbox"], select, option',this.hanldeFieldEvent),this.$form.prop("noValidate",!0).on("submit",this.handleSubmit)},hanldeFieldEvent:function(e){var t="on"+e.type;this.settings[t]&&this.settings[t].call(this,e.target,e)},handleSubmit:function(e){return this.validateForm()?this.pendingRequest>0?(this.formNeedSubmit=!0,!1):this.settings.submitHandler?(this.settings.submitHandler.call(this,this.$form[0],e),!1):void 0:!1},validateForm:function(){var e=this.checkForm();return this.errors().hide(),e||this.showErrors(),e},validateElement:function(e){if($(e).is(this.settings.ignore))return!0;e=this.validationTargetFor(e),this.reset();var t=this.check(e);return t?this.errorsFor(e).hide():this.showErrors(),t},check:function(e){e=this.validationTargetFor(e);var t=this.rulesFor(e),r=$(e).val();for(var i in t){var n={method:i,parameters:t[i]};try{var s=u.methods[i].call(this,r,e,n.parameters);if("pending"===s)return!0;if(!s)return this.addError(e,n),!1}catch(a){throw this.settings.debug&&window.console&&console.log("exception occured when checking element "+e.id+", check the '"+n.method+"' method",a),a}}return!0},checkForm:function(){return this.reset(),r.each(this.allElements(),function(e){this.check(e)},this),0===this.errorList.length},showErrors:function(e){if(this.settings.highlight&&r.each(this.errorList[i],function(e){this.settings.highlight.call(this,e.element)},this),this.settings.unhighlight){var t=r(this.errorList).map(function(){return this.element});r(this.allElements().not(t)).each(function(e){this.settings.unhighlight.call(this,e)},this)}this.settings.showErrors.call(this)},addError:function(e,t){var r=this.messageFor(e,t);this.errorList.push({message:r,element:e}),this.errorMap[e.name]=r},messageFor:function(e,t){var r=this.settings.messages[e.name];"object"==typeof r&&(r=r[t.method]),r||(r=u.methodMessages[t.method]||"缺少错误提示");var i=/\$?\{(\d+)\}/g;return"function"==typeof r?r=r.call(this,t.parameters,e):i.test(r)&&(r=u.formatMessage(r.replace(i,"{$1}"),t.parameters)),r},allElements:function(){var e={},t=this,i=this.$form.find("input, select, textarea").not('[type="submit"], [type="reset"], [type="image"], [disabled]').not(this.settings.ignore).filter(function(){return this.name in e||r.isEmpty(t.rulesFor(this))?!1:(e[this.name]=!0,!0)});return i},rulesFor:function(e){var t=r.extend({},this.rules[e.name]);if(t.required){var i=t.required;delete t.required,t=$.extend({required:i},t)}return t},validationTargetFor:function(e){return n.checkable(e)&&(e=n.findByName(e).not(this.settings.ignore)[0]),e},reset:function(){this.errorList=[],this.errorMap={},this.currentElements=$([])},errorsFor:function(e){var t=this.idOrName(e);return this.errors().filter('[for="'+t+'"]')},idOrName:function(e){return n.checkable(e)?e.name:e.id||e.name},errors:function(){var e=this.settings.errorClass.replace(" ",".");return $(this.settings.errorElement+"."+e,this.$form)},showErrorLabel:function(e,t){var r=this.errorsFor(e);r.length>0?r.html(t||"").show():(r=$("<"+this.settings.errorElement+"/>").attr("for",this.idOrName(e)).addClass(this.settings.errorClass).html(t||""),this.settings.errorPlacement?this.settings.errorPlacement.call(this,r,$(e)):r.insertAfter(e))},startRequest:function(e){this.pending[e.name]||(this.pendingRequest++,this.pending[e.name]=!0)},stopRequest:function(e,t){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[e.name],t&&0===this.pendingRequest&&this.formNeedSubmit&&this.checkForm()?(this.$form.submit(),this.formNeedSubmit=!1):!t&&0===this.pendingRequest&&this.formNeedSubmit&&(this.formNeedSubmit=!1)},previousValue:function(e){var t=$(e).data("previousValue");if(!t){var r={old:null,valid:!0};$(e).data("previousValue",JSON.stringify(r))}return t?JSON.parse(t):r}}),r.extend(u,{defaults:{errorClass:"error",errorElement:"label",ignore:"null",messages:{},onfocusout:function(e,t){n.checkable(e)||this.validateElement(e)},showErrors:function(){r.each(this.errorList,function(e){this.showErrorLabel(e.element,e.message)},this)}},addMethod:function(e,t,r){u.methods[e]=t,u.methodMessages[e]=r},setDefaults:function(e){r.extend(this.defaults,e)}},s,n),u});