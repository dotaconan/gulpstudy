define(function(require,e,u){var $=require("$"),F=require("underscore"),t=require("./touch-validator-util"),n={methods:{required:function(e,u,F){if(!t.depend(F,u))return!0;if("select"===u.nodeName.toLowerCase()){var n=$(u).val();return n&&n.length>0}return t.checkable(u)?t.getLength(e,u)>0:$.trim(e).length>0},remote:function(e,u,F){if(n.optional(u))return!0;if(this.pending[u.name])return"pending";var t=this.previousValue(u);if(t.old===e)return t.valid;t.old=e;var r=this;this.startRequest(u),F="string"==typeof F?{url:F}:F;var a={};return a[u.name]=e,$.ajax($.extend({uid:"validate"+u.name,dataType:"json",data:a,beforeSend:function(e,u){r.ajaxRequests[u.uid]&&r.ajaxRequests[u.uid].abort(),r.ajaxRequests[u.uid]=e},success:function(e){var F=e===!0||"true"===e;F?r.errorsFor(u).hide():(r.settings.messages[u.name]||(r.settings.messages[u.name]={}),t.message=r.settings.messages[u.name].remote=e,r.addError(u,{method:"remote"}),r.showErrors()),t.valid=F,$(u).data("previousValue",JSON.stringify(t)),r.stopRequest(u,F)}},F)),"pending"},minlength:function(e,u,r){var a=F.isArray(e)?e.length:t.getLength($.trim(e),u);return n.optional(u)||a>=r},maxlength:function(e,u,r){var a=F.isArray(e)?e.length:t.getLength($.trim(e),u);return n.optional(u)||r>=a},rangelength:function(e,u,r){var a=F.isArray(e)?e.length:t.getLength($.trim(e),u);return n.optional(u)||a>=r[0]&&a<=r[1]},min:function(e,u,F){return n.optional(u)||parseInt(e)>=t.depend(F,u)},max:function(e,u,F){return n.optional(u)||parseInt(e)<=t.depend(F,u)},range:function(e,u,F){return n.optional(u)||e>=F[0]&&e<=F[1]},email:function(e,u){return n.optional(u)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},number:function(e,u){return n.optional(u)||/^\d+$/i.test(e)},equalTo:function(e,u,F){var t=$(F);return e===t.val()}},methodMessages:{required:"请填写该字段",remote:"请修正该字段",email:"请输入正确的Email",url:"请输入正确的URL",number:"请输入合法的数字",digits:"请输入数字",equalTo:"请再次输入相同的值",maxlength:"请输入长度最大为{0}的字符串",minlength:"请输入长度至少为{0}的字符串",rangelength:"请输入长度在{0}到{1}之间的字符串",range:"请输入介于{0}和{1}之间的数字",max:"请输入最大为{0}的数字",min:"请输入最小为{0}的数字"},optional:function(e){var u=t.elementValue(e);return!n.methods.required.call(this,u,e)}};return n});