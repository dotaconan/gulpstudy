define("focus/date-picker/0.0.2/date-picker",["underscore","$","events","moment","modal","./scroll-picker","iscroll","./date-picker.html"],function(require){function i(i,e){return t.map(t.range(i,e+1),function(i){var t=i>9?i:"0"+i;return[t,i]})}var t=require("underscore"),$=require("$"),e=require("events"),s=require("moment"),n=require("modal"),a=require("./scroll-picker"),r=require("./date-picker.html"),l=1900,d=2030,c=function(){t.bindAll(this),e.mixTo(this),this.$el=$(r).appendTo("body"),this.modal=new n(this.$el),this.init()};return c.prototype={constructor:c,init:function(){this.yearPicker=new a(this.$el.find(".date")[0],{data:i(l,d)}),this.monthPicker=new a(this.$el.find(".date")[1],{data:i(1,12)}),this.dayPicker=new a(this.$el.find(".date")[2]),this.yearPicker.on("picked",this.handleYearMonthPick),this.monthPicker.on("picked",this.handleYearMonthPick),this.dayPicker.on("picked",this.handleDayPick),this.$el.find(".cancel").tap(this.hide),this.$el.find(".submit").tap(this.submit)},show:function(i){this.modal.show(),i=i||{};var e=i.date||s();t.isString(e)&&(e=s(e)),this.yearPicker.gotoIndex(e.year()-l),this.monthPicker.gotoIndex(e.month()-0),this.dayPicker.gotoIndex(e.date()-1)},hide:function(){this.modal.hide()},submit:function(){this.hide(),this.trigger("submit",this.date)},handleYearMonthPick:function(){if(this.yearPicker.value&&this.monthPicker.value){var t=s([this.yearPicker.value,this.monthPicker.value-1]).daysInMonth(),e=this.dayPicker.getIndex();this.dayPicker.render({data:i(1,t)}),this.dayPicker.gotoIndex(e||0);var n=this.monthPicker.$list.find("li.current"),a=parseInt(n.data("pos")),r=(n.siblings().length-1)/3;2!=a&&this.monthPicker.gotoIndex(this.monthPicker.getIndex()+(a>2?-1:1)*r)}},handleDayPick:function(){this.date=s([this.yearPicker.value,this.monthPicker.value-1,this.dayPicker.value]),this.$el.find(".date-title").text(this.date.format("YYYY-MM-DD ddd")),this.renderFestival();var i=this.dayPicker.$list.find("li.current"),t=parseInt(i.data("pos")),e=(i.siblings().length-1)/3;2!=t&&this.dayPicker.gotoIndex(this.dayPicker.getIndex()+(t>2?-1:1)*e)},renderFestival:function(){s().startOf("day").isSame(this.date)?this.$el.find(".date-descr").text("今天"):this.$el.find(".date-descr").text("")}},c.create=function(i){c.instance||(c.instance=new c,c.instance.on("submit",function(i){$(c.relatedInput).val(i.format("YYYY-MM-DD")).attr("formnovalidate",!1).trigger("change")})),$(i).focus(function(){if(!this.readOnly&&!this.disabled){$(this).attr("formnovalidate",!0),this.blur(),this.disabled=!0;var i=this;setTimeout(function(){i.disabled=!1},1),c.instance.show({date:this.value}),c.relatedInput=this}})},s.lang("zh",{weekdaysShort:"周日 周一 周二 周三 周四 周五 周六".split(" ")}),c}),define("focus/date-picker/0.0.2/scroll-picker",["underscore","$","events","iscroll"],function(require,i,t){var e=require("underscore"),$=require("$"),s=require("events"),n=require("iscroll"),a=function(i,t){e.bindAll(this),s.mixTo(this),this.$list=$(i).find(".lists"),this.iscroll=new n(this.$list[0],{vScrollbar:!1,hScrollbar:!1,snap:"li",onScrollEnd:this.handlePick}),this.render(t)};return a.prototype={constructor:a,handlePick:function(){return this.iscroll.currPageY>=this.iscroll.pagesY.length-2?void this.iscroll.scrollToPage(0,this.iscroll.pagesY.length-3,0):(this.$currEl&&this.$currEl.removeClass("current"),this.$currEl=this.$list.find("li").eq(this.iscroll.currPageY+1),this.$currEl.addClass("current"),this.value=this.$currEl.data("value"),void this.trigger("picked"))},render:function(i){if(i&&i.data){this.$list.find("li[data-value]").remove();for(var t=1;4>t;t++)e.each(i.data,function(i){this.$list.find("li:last").before('<li data-value="'+i[1]+'" data-pos="'+t+'">'+i[0]+"</li>")},this)}},getIndex:function(){return this.iscroll.currPageY},gotoIndex:function(i){this.iscroll.refresh(),this.iscroll.scrollToPage(0,i,0)},gotoEl:function(i){this.iscroll.refresh(),this.iscroll.scrollToElement($(i)[0],0)}},a}),define("focus/date-picker/0.0.2/date-picker.html",[],'<div class="md-input-date" style="display: none;">\n    <div class="ly-clearFix title">\n        <div class="ly-left date-title"></div>\n        <div class="ly-right date-descr"></div>\n    </div>\n    <div class="content">\n        <div class="dates ly-clearFix">\n            <div class="date">\n                <a href="javascript:void(0);" class="tri tri-up"></a>\n                <a href="javascript:void(0);" class="tri tri-down"></a>\n\n                <div class="lists">\n                    <ul>\n                        <li></li>\n                        <li></li>\n                    </ul>\n                    <span class="hex hex1"></span>\n                    <span class="hex hex2"></span>\n                </div>\n            </div>\n            <div class="date">\n                <a href="javascript:void(0);" class="tri tri-up"></a>\n                <a href="javascript:void(0);" class="tri tri-down"></a>\n\n                <div class="lists">\n                    <ul>\n                        <li></li>\n                        <li></li>\n                    </ul>\n                    <span class="hex hex1"></span>\n                    <span class="hex hex2"></span>\n                </div>\n            </div>\n            <div class="date">\n                <a href="javascript:void(0);" class="tri tri-up"></a>\n                <a href="javascript:void(0);" class="tri tri-down"></a>\n\n                <div class="lists">\n                    <ul>\n                        <li></li>\n                        <li></li>\n                    </ul>\n                    <span class="hex hex1"></span>\n                    <span class="hex hex2"></span>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="action">\n        <a href="javascript:void(0)" title="" class="cancel">取消</a>\n        <a href="javascript:void(0)" title="" class="submit">确定</a>\n    </div>\n</div>');