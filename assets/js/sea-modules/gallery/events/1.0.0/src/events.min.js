define(function(){function t(){}var r=/\s+/;t.prototype.on=function(t,e,i){var n,s,o;if(!e)return this;for(n=this.__events||(this.__events={}),t=t.split(r);s=t.shift();)o=n[s]||(n[s]=[]),o.push(e,i);return this},t.prototype.off=function(t,i,n){var s,o,f,h;if(!(s=this.__events))return this;if(!(t||i||n))return delete this.__events,this;for(t=t?t.split(r):e(s);o=t.shift();)if(f=s[o])if(i||n)for(h=f.length-2;h>=0;h-=2)i&&f[h]!==i||n&&f[h+1]!==n||f.splice(h,2);else delete s[o];return this},t.prototype.trigger=function(t){var e,i,n,s,o,f,h,p=[];if(!(e=this.__events))return this;for(t=t.split(r),o=1,f=arguments.length;f>o;o++)p[o-1]=arguments[o];for(;i=t.shift();){if((n=e.all)&&(n=n.slice()),(s=e[i])&&(s=s.slice()),s)for(o=0,f=s.length;f>o;o+=2)s[o].apply(s[o+1]||this,p);if(n)for(h=[i].concat(p),o=0,f=n.length;f>o;o+=2)n[o].apply(n[o+1]||this,h)}return this},t.mixTo=function(r){r=r.prototype||r;var e=t.prototype;for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i])};var e=Object.keys;return e||(e=function(t){var r=[];for(var e in t)t.hasOwnProperty(e)&&r.push(e);return r}),t});